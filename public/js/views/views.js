window.AdminHeaderView=Backbone.View.extend({render:function(){$(this.el).html(this.template());return this},select:function(a){$(".nav li").removeClass("active");$("."+a).addClass("active")}});BolaoCopa.View=Backbone.View.extend({render:function(){if(this.model)var a=this.template(this.model.toJSON());else a=$(this.template()).html(),a=_.template(a);this.$el.html(a);return this}});BolaoCopa.ItemView=BolaoCopa.View.extend({remove:function(){confirm("Voc\u00ea deseja realmente remover este item?")&&this.model.destroy()}});
BolaoCopa.ListView=Backbone.View.extend({initialize:function(){},render:function(){var a=this,d=[];(new this.collection).fetch({success:function(c,e,b){_.each(c.models,function(b){b=new a.ItemView({model:b});d.push(b.render().el)});a.$el.append(d);return a},error:function(a,d,b){"Bad Request"==d.statusText||"Internal Server Error"==d.statusText?($.logThis("Erro! "+d.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):
humane.log(d.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}})}});window.ContactView=Backbone.View.extend({initialize:function(){$.logThis("Initializing Contact View")},render:function(){$(this.el).html(this.template());return this}});window.EmployeeView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){$(this.el).html(this.template(this.model.toJSON()));$("#details",this.el).html((new EmployeeSummaryView({model:this.model})).render().el);this.model.reports.fetch({success:function(a){0==a.length&&$(".no-reports").show()}});$("#reports",this.el).append((new EmployeeListView({model:this.model.reports})).render().el);return this}});
window.EmployeeSummaryView=Backbone.View.extend({tagName:"div",initialize:function(){this.model.bind("change",this.render,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.EmployeeListView=Backbone.View.extend({tagName:"ul",className:"nav nav-list",initialize:function(){var a=this;this.model.bind("reset",this.render,this);this.model.bind("add",function(d){$(a.el).append((new EmployeeListItemView({model:d})).render().el)})},render:function(){$(this.el).empty();_.each(this.model.models,function(a){$(this.el).append((new EmployeeListItemView({model:a})).render().el)},this);return this}});
window.EmployeeListItemView=Backbone.View.extend({tagName:"li",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.EquipeListView=Backbone.View.extend({tagName:"table",className:"table table-striped table-condensed",session:null,render:function(){var a=this;$(this.el).empty();(new EquipeCollection).fetch({success:function(d,c,e){$(a.el).append((new EquipeListItemViewHeader).render().el);$(a.el).append((new EquipeListItemViewAddHeader).render().el);$(a.el).append('<tr><td colspan="3" class="td-right td-left">&nbsp;</td></tr>');$(a.el).append((new EquipeListItemViewHeader).render().el);_.each(d.models,function(b){$(a.el).append((new EquipeListItemView({model:b})).render().el)},
this);$(".equipeeditablenew").editable({placement:"bottom",url:"/post",emptytext:"Vazio"});$(".equipeeditablenew").on("save.newequipe",function(){var b=this;setTimeout(function(){$(b).closest("tr").next().find(".equipeeditablenew").editable("show")},200)});$("#equipe-nome").editable("option","validate",function(b){if(!b)return"Campo obrigat\u00f3rio!"});$("#novaequipe").click(function(){$(".equipeeditablenew").editable("submit",{url:"/equipes",ajaxOptions:{dataType:"json"},success:function(b,c){if(b&&
b.id){var d=new Equipe;d.attributes=b;$(".equipeeditablenew").editable("setValue","").editable("option","pk",null);humane.log("Salvo com sucesso!",{addnCls:"humane-boldlight-success"});$(this).off("save.newequipe");$(a.el).append((new EquipeListItemView({model:d})).render().el);configura_EquipeEditable_BtnApagar()}else b&&b.errors&&c.error.call(this,b.errors)},error:function(b){var a="";b&&b.responseText?a=b.getResponseHeader("X-Status-Reason"):$.each(b,function(b,d){a+=b+": "+d+"<br>"});humane.log(a,
{addnCls:"humane-boldlight-error"})}})});configura_EquipeEditable_BtnApagar()},error:function(a,c,e){"Bad Request"==c.statusText||"Internal Server Error"==c.statusText?($.logThis("Erro! "+c.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(c.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}});return a}});
window.EquipeListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.EquipeListItemViewHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});
window.EquipeListItemViewAddHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});window.EquipeView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){$(this.el).empty();$(this.el).html(this.template());$(this.el).append((new EquipeListView).render().el);return this}});
window.configura_EquipeEditable_BtnApagar=function(){$(".equipeeditable").editable({placement:"bottom",url:"/equipes",emptytext:"?"});$(".btn-apagar").click(function(){var a=this;$equipe=new Equipe;$equipe.set("id",this.dataset.pk);$equipe.destroy({success:function(d,c){c.error?$.logThis("Erro! "+c.responseText):(humane.log("Removido com sucesso!",{addnCls:"humane-boldlight-success"}),$(a).closest("tr").remove())},error:function(a,c){$.logThis("Erro! "+c.responseText);humane.log("Erro ao remover! Entre em contato com o suporte. ",
{addnCls:"humane-boldlight-error"})}})})};window.FaseListView=Backbone.View.extend({tagName:"table",className:"table table-striped table-condensed",session:null,render:function(){var a=this;$(this.el).empty();(new FaseCollection).fetch({success:function(d,c,e){$(a.el).append((new FaseListItemViewHeader).render().el);$(a.el).append((new FaseListItemViewAddHeader).render().el);$(a.el).append('<tr><td colspan="2" class="td-right td-left">&nbsp;</td></tr>');$(a.el).append((new FaseListItemViewHeader).render().el);_.each(d.models,function(b){$(a.el).append((new FaseListItemView({model:b})).render().el)},
this);$(".faseeditablenew").editable({placement:"bottom",url:"/post",emptytext:"Vazio"});$(".faseeditablenew").on("save.newfase",function(){var b=this;setTimeout(function(){$(b).closest("tr").next().find(".faseeditablenew").editable("show")},200)});$("#fase-nome").editable("option","validate",function(b){if(!b)return"Campo obrigat\u00f3rio!"});$("#novafase").click(function(){$(".faseeditablenew").editable("submit",{url:"/fases",ajaxOptions:{dataType:"json"},success:function(b,d){if(b&&b.id){var c=
new Fase;c.attributes=b;$(".faseeditablenew").editable("setValue","").editable("option","pk",null);humane.log("Salvo com sucesso!",{addnCls:"humane-boldlight-success"});$(this).off("save.newfase");$(a.el).append((new FaseListItemView({model:c})).render().el);configura_FaseEditable_BtnApagar()}else b&&b.errors&&d.error.call(this,b.errors)},error:function(b){var a="";b&&b.responseText?a=b.getResponseHeader("X-Status-Reason"):$.each(b,function(b,c){a+=b+": "+c+"<br>"});humane.log(a,{addnCls:"humane-boldlight-error"})}})});
configura_FaseEditable_BtnApagar()},error:function(a,c,e){"Bad Request"==c.statusText||"Internal Server Error"==c.statusText?($.logThis("Erro! "+c.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(c.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}});return a}});
window.FaseListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.FaseListItemViewHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});
window.FaseListItemViewAddHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});window.FaseView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){$(this.el).empty();$(this.el).html(this.template());$(this.el).append((new FaseListView).render().el);return this}});
window.configura_FaseEditable_BtnApagar=function(){$(".faseeditable").editable({placement:"bottom",url:"/fases",emptytext:"?"});$(".btn-apagar").click(function(){var a=this;$fase=new Fase;$fase.set("id",this.dataset.pk);$fase.destroy({success:function(d,c){c.error?$.logThis("Erro! "+c.responseText):(humane.log("Removido com sucesso!",{addnCls:"humane-boldlight-success"}),$(a).closest("tr").remove())},error:function(a,c){$.logThis("Erro! "+c.responseText);humane.log("Erro ao remover! Entre em contato com o suporte. ",
{addnCls:"humane-boldlight-error"})}})})};window.HeaderView=Backbone.View.extend({initialize:function(){this.searchResults=new EmployeeCollection;this.searchresultsView=new EmployeeListView({model:this.searchResults,className:"dropdown-menu"})},render:function(){$(this.el).html(this.template());return this},events:{"keyup .search-query":"search","keypress .search-query":"onkeypress"},search:function(){var a=$("#searchText").val();$.logThis("search "+a);this.searchResults.findByName(a);setTimeout(function(){$(".dropdown").addClass("open")})},
onkeypress:function(a){13==a.keyCode&&a.preventDefault()},select:function(a){$(".nav li").removeClass("active");$("."+a).addClass("active")}});window.IdentificationView=Backbone.View.extend({initialize:function(){update=function(){$.logThis(moment().format("hh:mm:ss a"));$("#time").text("Bras\u00edlia, "+moment().format("DD/MM/YYYY HH:mm:ss"))};x=setInterval(update,1E3);setTimeout(function(){return clearInterval(x)},1E4)},render:function(){$(this.el).html(this.template());return this}});window.LocalListView=Backbone.View.extend({tagName:"table",className:"table table-striped table-condensed",session:null,render:function(){var a=this;$(this.el).empty();(new LocalCollection).fetch({success:function(d,c,e){$(a.el).append((new LocalListItemViewHeader).render().el);$(a.el).append((new LocalListItemViewAddHeader).render().el);$(a.el).append('<tr><td colspan="2" class="td-right td-left">&nbsp;</td></tr>');$(a.el).append((new LocalListItemViewHeader).render().el);_.each(d.models,function(b){$(a.el).append((new LocalListItemView({model:b})).render().el)},
this);$(".localeditablenew").editable({placement:"bottom",url:"/post",emptytext:"Vazio"});$(".localeditablenew").on("save.newlocal",function(){var a=this;setTimeout(function(){$(a).closest("tr").next().find(".localeditablenew").editable("show")},200)});$("#local-nome").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#novolocal").click(function(){$(".localeditablenew").editable("submit",{url:"/locais",ajaxOptions:{dataType:"json"},success:function(b,c){if(b&&b.id){var d=
new Local;d.attributes=b;$(".localeditablenew").editable("setValue","").editable("option","pk",null);humane.log("Salvo com sucesso!",{addnCls:"humane-boldlight-success"});$(this).off("save.newlocal");$(a.el).append((new LocalListItemView({model:d})).render().el);configura_LocalEditable_BtnApagar()}else b&&b.errors&&c.error.call(this,b.errors)},error:function(a){var c="";a&&a.responseText?c=a.getResponseHeader("X-Status-Reason"):$.each(a,function(a,b){c+=a+": "+b+"<br>"});humane.log(c,{addnCls:"humane-boldlight-error"})}})});
configura_LocalEditable_BtnApagar()},error:function(a,c,e){"Bad Request"==c.statusText||"Internal Server Error"==c.statusText?($.logThis("Erro! "+c.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(c.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}});return a}});
window.LocalListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.LocalListItemViewHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});
window.LocalListItemViewAddHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});window.LocalView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){$(this.el).empty();$(this.el).html(this.template());$(this.el).append((new LocalListView).render().el);return this}});
window.configura_LocalEditable_BtnApagar=function(){$(".localeditable").editable({placement:"bottom",url:"/locais",emptytext:"?"});$(".btn-apagar").click(function(){var a=this;$local=new Local;$local.set("id",this.dataset.pk);$local.destroy({success:function(d,c){c.error?$.logThis("Erro! "+c.responseText):(humane.log("Removido com sucesso!",{addnCls:"humane-boldlight-success"}),$(a).closest("tr").remove())},error:function(a,c){$.logThis("Erro! "+c.responseText);humane.log("Erro ao remover! Entre em contato com o suporte. ",
{addnCls:"humane-boldlight-error"})}})})};window.LoginView=Backbone.View.extend({initialize:function(){$.logThis("Initializing Login View")},events:{"click #loginButton":"login"},render:function(){$(this.el).html(this.template());return this},login:function(a){a.preventDefault();$(".alert-error").hide();a=CryptoJS.SHA3($("#senha").val(),{outputLength:512}).toString(CryptoJS.enc.Base64);console.log("Logging in...");$.logThis("Logging in...");a={email:$("#email").val(),senha:a};$.ajax({url:"../login",type:"POST",datatype:"json",data:a,success:function(a,
c,e){$.logThis(["Login request details: ",a]);a.error?$(".alert-error").text(a.error.text).show():($.cookie("usuario_id",a.usuario_id,{expires:2,path:"/"}),$.cookie("session_id",a.session_id,{expires:2,path:"/"}),$.cookie("usuario_nome",a.nome,{expires:2,path:"/"}),$.cookie("papel",a.papel,{expires:2,path:"/"}),templateLoader.load(["RegrasView"],function(){window.location.replace("#regras")}))},error:function(a,c,e){"Bad Request"==e||"Internal Server Error"==e?($.logThis("Erro! "+a.getResponseHeader("X-Status-Reason")),
humane.log("Erro de servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(a.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}})}});window.PalpiteListView=Backbone.View.extend({tagName:"table",className:"table table-striped table-condensed",session:null,initialize:function(){this.session=new SessionModel},render:function(){var a=this;$(this.el).empty();var d=this.session.get("usuario_id");(new BolaoCopa.Usuario({id:d})).palpites.fetch({success:function(c,d,b){var p="",r="",h=0,q=0,v=0;_.each(c.models,function(b){p=b.partida.attributes.fase.nom_fase;p!=r&&(""!=r&&($(a.el).append('<tr><th colspan="19" class="td-right td-left th-right">Sub-total</th><th class="td-right">'+
h+"</th></tr>"),q+=h,h=0),$(a.el).append((new PalpiteListItemViewFaseHeader({model:b})).render().el),$(a.el).append((new PalpiteListItemViewHeader).render().el),r=p);h+=parseInt(b.attributes.qtd_pontos);$(a.el).append((new PalpiteListItemView({model:b})).render().el);b.collection.length==++v&&($(a.el).append('<tr><th colspan="19" class="td-right th-right">Sub-total</th><th class="td-right">'+h+"</th></tr>"),q+=h)},this);$(a.el).append('<tr><th colspan="19" class="td-right td-left th-right">Total</th><th class="td-right">'+
q+"</th></tr>");$(".qtd_gols_equipe_1").editable({type:"text",placement:"left",name:"qtd_gols_equipe_1",title:"Gols da equipe 1",url:"/palpites",emptytext:"?"});$(".qtd_gols_equipe_2").editable({type:"text",placement:"right",name:"qtd_gols_equipe_2",title:"Gols da equipe 2",url:"/palpites",emptytext:"?"});$(".qtd_gols_equipe_1").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!";if(isNaN(parseFloat(a))||!(isFinite(a)&&0==a-parseInt(a)))return"Deve ser um n\u00famero inteiro!"});
$(".qtd_gols_equipe_2").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!";if(isNaN(parseFloat(a))||!(isFinite(a)&&0==a-parseInt(a)))return"Deve ser um n\u00famero inteiro!"})},error:function(a,d,b){"Bad Request"==d.statusText||"Internal Server Error"==d.statusText?($.logThis("Erro! "+d.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(d.getResponseHeader("X-Status-Reason"),
{addnCls:"humane-boldlight-error"})}});return a}});window.PalpiteListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.PalpiteListItemViewFaseHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});
window.PalpiteListItemViewHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});window.PartidaListView=Backbone.View.extend({tagName:"table",className:"table table-striped table-condensed",session:null,initialize:function(){$.mockjax({url:"/status",responseText:{"A iniciar":"A iniciar","Em andamento":"Em andamento",Encerrado:"Encerrado"}})},render:function(){var a=this;$(this.el).empty();(new PartidaCollection).fetch({success:function(d,c,e){$(a.el).append((new PartidaListItemViewHeader).render().el);$(a.el).append((new PartidaListItemViewAddHeader).render().el);$(a.el).append('<tr><td colspan="14" class="td-right td-left">&nbsp;</td></tr>');
$(a.el).append((new PartidaListItemViewHeader).render().el);_.each(d.models,function(b){$(a.el).append((new PartidaListItemView({model:b})).render().el)},this);$(".partidaeditablenew").editable({format:"YYYY-MM-DD HH:mm:00",viewformat:"DD/MM/YYYY HH:mm",template:"DD/MM/YYYY HH:mm",combodate:{minYear:2E3,maxYear:2015,minuteStep:10},placement:"bottom",url:"/post",emptytext:"Vazio"});$(".partidaeditablenew").on("save.newpartida",function(){var a=this;setTimeout(function(){$(a).closest("tr").next().find(".partidaeditablenew").editable("show")},
200)});$("#partida-fase").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#partida-grupo").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#partida-numero").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#partida-data").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#partida-local").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});
$("#partida-equipe-1").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#partida-equipe-2").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#partida-status").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!"});$("#novapartida").click(function(){$(".partidaeditablenew").editable("submit",{url:"/partidas",ajaxOptions:{dataType:"json"},success:function(b,c){if(b&&b.id){var d=new Partida;d.attributes=b;
$(".partidaeditablenew").editable("setValue","").editable("option","pk",null);humane.log("Salvo com sucesso!",{timeout:500,clickToClose:!0,addnCls:"humane-boldlight-success"});$(this).off("save.newpartida");$(a.el).append((new PartidaListItemView({model:d})).render().el);configura_PartidaEditable_BtnApagar()}else b&&b.errors&&c.error.call(this,b.errors)},error:function(a){var c="";a&&a.responseText?c=a.getResponseHeader("X-Status-Reason"):$.each(a,function(a,b){c+=a+": "+b+"<br>"});humane.log(c,{addnCls:"humane-boldlight-error"})}})});
configura_PartidaEditable_BtnApagar()},error:function(a,c,e){"Bad Request"==c.statusText||"Internal Server Error"==c.statusText?($.logThis("Erro! "+c.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(c.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}});return a}});
window.PartidaListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this}});window.PartidaListItemViewHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});
window.PartidaListItemViewAddHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});window.PartidaView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){$(this.el).empty();$(this.el).html(this.template());$(this.el).append((new PartidaListView).render().el);return this}});
window.configura_PartidaEditable_BtnApagar=function(){$(".partidaeditable").editable({format:"YYYY-MM-DD HH:mm:00",viewformat:"DD/MM/YYYY HH:mm",template:"DD/MM/YYYY HH:mm",combodate:{minYear:2E3,maxYear:2015,minuteStep:10},placement:"bottom",url:"/partidas",emptytext:"?"});$(".btn-apagar").click(function(){var a=this;$partida=new Partida;$partida.set("id",this.dataset.pk);$partida.destroy({success:function(d,c){c.error?$.logThis("Erro! "+c.responseText):(humane.log("Removido com sucesso!",{addnCls:"humane-boldlight-success"}),
$(a).closest("tr").remove())},error:function(a,c){$.logThis("Erro! "+c.responseText);humane.log("Erro ao remover! Entre em contato com o suporte. ",{addnCls:"humane-boldlight-error"})}})})};window.RegrasView=Backbone.View.extend({initialize:function(){$.logThis("Initializing Regras View")},events:{"click #showMeBtn":"showMeBtnClick","click #btn-exemplo":"showExemplo"},render:function(){$(this.el).html(this.template());return this},showMeBtnClick:function(){app.headerView.search()},showExemplo:function(){$table='<table class="table table-striped table-bordered table-hover table-condensed table-left"><thead><tr><th>Resultado</th><th>Palpite</th><th>Pontos</th><th>Descri\u00e7\u00e3o</th></tr></thead>';
$table+="<tbody><tr><td>2 x 1</td><td>0 x 0</td><td>0</td><td>Nenhum ponto</td></tr>";$table+='<tr class="info"><td>2 x 1</td><td>2 x 3</td><td>1</td><td>1(um) ponto por acertar o n\u00famero de gols do primeiro time</td></tr>';$table+="<tr><td>2 x 1</td><td>3 x 0</td><td>2</td><td>2(dois) pontos por acertar o tipo de resultado (vit\u00f3ria do primeiro time)</td></tr>";$table+='<tr class="info"><td>2 x 1</td><td>3 x 1</td><td>3</td><td>2(dois) pontos por acertar o tipo de resultado e <br />1(um) ponto por acertar o n\u00famero de gols do segundo time</td></tr>';
$table+='<tr><td>2 x 1</td><td>2 x 1</td><td>5</td><td style="text-align: left;">2(dois) pontos por acertar o tipo de resultado, <br />2(dois) pontos por acertar o n\u00famero de gols do primeiro e do segundo time e <br />1(um) ponto para o resultado id\u00eantico</td></tr></tbody></table>';humane.log($table,{timeout:2E4,clickToClose:!0,addnCls:"humane-jackedup"})}});window.ResultadoView=Backbone.View.extend({tagName:"div",nomeFase:"",session:null,initialize:function(){this.session=new SessionModel},render:function(){$("#buttons").html("");this.resultadoButtonView||(this.resultadoButtonView=new ResultadoButtonView);$("#buttons").html(this.resultadoButtonView.render().el);"Todas as Fases"===this.options.nomeFase?(new ResultadoGridViewTodasFases).render():(new ResultadoGridViewFase({nomeFase:this.options.nomeFase})).render()}});
window.ResultadoButtonView=Backbone.View.extend({tagName:"div",className:"row",initialize:function(){},render:function(){$(this.el).empty();$(this.el).html(this.template());return this}});
window.ResultadoGridViewFase=Backbone.View.extend({tagName:"table",className:"table table-striped-blue table-condensed",nomeFase:"",initialize:function(){},render:function(){$(this.el).empty();var a=this,d="";(new PartidaCollection).fetch({success:function(c,e,b){var p=0,r="",h="",q="",v="",s="",w="",B="",k={partidas:[],usuarios:[]};_.each(c.models,function(b){r=b.attributes.fase.nom_fase;r===a.options.nomeFase&&(k.fase=r,""===d&&(d=r.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,"_").toLowerCase(),
k.faseFiltered=d),h=b.attributes.num_partida,v=b.attributes.equipe_1.nom_equipe,s=b.attributes.equipe_2.nom_equipe,w=b.attributes.qtd_gols_equipe_1?b.attributes.qtd_gols_equipe_1:"--",B=b.attributes.qtd_gols_equipe_2?b.attributes.qtd_gols_equipe_2:"--",q=w+" x "+B,p+=4,k.partidas.push(Object({numpartida:h,resultado:q,equipe1:v,equipe2:s})))},this);p+=3;(new PalpiteCollection).fetch({success:function(b,c,d){var e,f=0;c=[];var g=[];d=g=0;var h="",s=e="",v="",w=0,l,m;_.sortBy(b.models,function(a){return a.usuario.attributes.nome});
for(l=0;l<b.models.length;l+=1)r=b.models[l].partida.attributes.fase.nom_fase,r==a.options.nomeFase&&(h=b.models[l].usuario.attributes.nome,g=b.models[l].usuario.attributes.contribuicao?retornaContribuicao(r,parseFloat(b.models[l].usuario.attributes.contribuicao)):0,h!==e&&(""!==e&&(c.push(f),f=0),d+=g),e=b.models[l].attributes.qtd_pontos,f+=parseInt(e,10),e=h);c.push(f);g=ordenaColocacao(c);e=h="";for(l=0;l<b.models.length;l+=1)if(m=-1,r=b.models[l].partida.attributes.fase.nom_fase,r===a.options.nomeFase){h=
b.models[l].usuario.attributes.nome;if(h!==e&&""!==e){for(f=0;f<k.usuarios.length;f+=1)k.usuarios[f].usuario===e&&(m=f);0<=m&&(k.usuarios[m].total=c[w],k.usuarios[m].colocacao=g[w],m=-1);w++}s=b.models[l].attributes.qtd_gols_equipe_1?b.models[l].attributes.qtd_gols_equipe_1:"--";v=b.models[l].attributes.qtd_gols_equipe_2?b.models[l].attributes.qtd_gols_equipe_2:"--";q=s+" x "+v;e=b.models[l].attributes.qtd_pontos;for(f=f=0;f<k.usuarios.length;f+=1)k.usuarios[f].usuario===h&&(m=f);0>m?k.usuarios.push(Object({usuario:h,
palpites:[{palpite:q,pontos:e}]})):(k.usuarios[m].palpites.push(Object({palpite:q,pontos:e})),m=-1);e=h}for(l=0;l<k.usuarios.length;l++)k.usuarios[l].usuario===h&&(m=l);0<=m&&(k.usuarios[m].total=c[w],k.usuarios[m].colocacao=g[w],m=-1);k.contribuicao=d;k.colspan=p;$("#content").html($(a.el).html(a.template(k)))},error:function(a,b,c){"Bad Request"===b.statusText||"Internal Server Error"===b.statusText?($.logThis("Erro! "+b.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",
{addnCls:"humane-boldlight-error"})):humane.log(b.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}})},error:function(a,d,b){"Bad Request"===d.statusText||"Internal Server Error"===d.statusText?($.logThis("Erro! "+d.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(d.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}})}});
window.ResultadoGridViewTodasFases=Backbone.View.extend({tagName:"table",className:"table table-striped-blue table-condensed",initialize:function(){},render:function(){var a=this;$(this.el).empty();(new PalpiteCollection).fetch({success:function(d,c,e){var b="",p="",r="",h=0,q=[],v,s=0,w=[],B=[],k=0,y=0,u="",t="",A=0,f,g={fases:[],usuarios:[]};_.each(d.models,function(a){b=a.partida.attributes.fase.nom_fase;b!==p&&(-1===q.indexOf(b)&&(r=b.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,"_").toLowerCase(),
q.push(b),h++,g.fases.push({fase:b,fasefiltered:r})),k=a.usuario.attributes.contribuicao?retornaContribuicao(b,parseFloat(a.usuario.attributes.contribuicao)):0,y+=k);u=a.usuario.attributes.nome;u!==t&&""!==t&&(w.push(s),s=0);v=a.attributes.qtd_pontos;s+=parseInt(v,10);t=u;p=b},this);w.push(s);h+=3;g.colspan=h;g.contribuicao=y;B=ordenaColocacao(w);p=b=t=u="";r="todas-fases";q=[];A=s=0;_.each(d.models,function(a){b=a.partida.attributes.fase.nom_fase;if(b!==p&&""!==p){f=0;for(achou=-1;f<g.usuarios.length;f+=
1)if(g.usuarios[f].usuario===(u!==t?t:u))achou=f;0<=achou&&(g.usuarios[achou].pontosFases.push(Object({fase:p,pontos:s})),achou=-1);s=0}u=a.usuario.attributes.nome;if(u!==t){if(""!==t){f=0;for(achou=-1;f<g.usuarios.length;f+=1)g.usuarios[f].usuario===t&&(achou=f);0<=achou&&(g.usuarios[achou].total=w[A],g.usuarios[achou].colocacao=B[A],achou=-1);A++}f=0;for(achou=-1;f<g.usuarios.length;f+=1)g.usuarios[f].usuario===u&&(achou=f);0>achou&&g.usuarios.push(Object({usuario:u,pontosFases:[]}))}v=a.attributes.qtd_pontos;
s+=parseInt(v,10);t=u;p=b},this);f=0;for(achou=-1;f<g.usuarios.length;f+=1)g.usuarios[f].usuario===u&&(achou=f);0<=achou&&(g.usuarios[achou].pontosFases.push(Object({fase:b,pontos:s})),g.usuarios[achou].total=w[A],g.usuarios[achou].colocacao=B[A],achou=-1);$("#content").html($(a.el).html(a.template(g)))},error:function(a,c,e){"Bad Request"===c.statusText||"Internal Server Error"===c.statusText?($.logThis("Erro! "+c.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",
{addnCls:"humane-boldlight-error"})):humane.log(c.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}})}});
function ordenaColocacao(a){for(var d=[],c=[],e=!0,b=a.length;b--;)d.push(a.length-b-1),c.push(0);for(b=0;b<a.length;b++)0!==a[b]&&(e=!1);if(!e){d.sort(function(b,c){var d=a[b],e=a[c];if("number"!==typeof d||isNaN(d))d=-Infinity;if("number"!==typeof e||isNaN(e))e=-Infinity;return d<e?1:e<d?-1:0});e=a.slice();e.sort(function(a,b){return a-b});e.reverse();for(var p=999999,r=0,b=0;b<d.length;b++)e[b]<p&&r++,c[d[b]]=r,p=e[b]}return c}
function retornaContribuicao(a,d){switch(a){case "Fase de Grupos - 1\u00aa Rodada":return 50>d?0:5;case "Fase de Grupos - 2\u00aa Rodada":return 40>d?0:5;case "Fase de Grupos - 3\u00aa Rodada":return 30>d?0:5;case "Semifinais":return 20>d?0:5;case "Finais":return 10>d?0:5;default:return 0}}
function resultadoGrafico(){var a=[],d=[];(new PalpiteCollection).fetch({success:function(c,e,b){function p(){clearTimeout(H);"grouped"===this.value?r():h()}function r(){C.domain([0,G]);E.transition().duration(500).delay(function(a,b){return 10*b}).attr("y",function(a,b,c){return m(a.x)+m.rangeBand()/n*c}).attr("height",m.rangeBand()/n).transition().attr("x",function(a){return C(a.y)}).attr("width",function(a){return C(a.y)})}function h(){C.domain([0,l]);E.transition().duration(500).delay(function(a,
b){return 10*b}).attr("x",function(a){return C(a.y0+a.y)}).attr("width",function(a){return C(a.y0)-C(a.y0+a.y)}).transition().attr("y",function(a){return m(a.x)}).attr("height",m.rangeBand())}var q="",v="",s=[],w=0,B=0,k=0,y="",u="",t=[],A=0,f=[],g,F;_.each(c.models,function(a){var b;k=B;y=a.usuario.attributes.nome;q=a.partida.attributes.fase.nom_fase;if(q!==v)if(B=0,-1===s.indexOf(q)&&(f.push(Object({fase:q,values:[]})),s.push(q)),""!==v&&(A=s.indexOf(v),-1===t.indexOf(y)&&t.push(y),y!==u?f[A].values.push(Object({x:t.indexOf(y),
y:k})):f[A].values.push(Object({x:t.indexOf(u),y:k}))),y!==u){for(b in d)d[b].usuario===u&&(g=d[b].total,g+=F,d[b].total=g);d.push(Object({usuario:y,total:0}))}else for(b in d)d[b].usuario===y&&(g=d[b].total,g+=k,d[b].total=g);w=a.attributes.qtd_pontos;F=B+=parseInt(w,10);u=y;v=q},this);A=s.indexOf(q);f[A].values.push(Object({x:t.indexOf(y),y:k}));for(var z in d)d[z].usuario===y&&(g=d[z].total,g+=k,d[z].total=g);c=d3.max(t,function(a){return a.length});b=d3.layout.stack().values(function(a){return a.values});
z=9*c;c=940-z-20;e=Math.max(20*t.length,400);var D=b(f),G=d3.max(D,function(a){return d3.max(a.values,function(a){return a.y})}),l=d3.max(D,function(a){return d3.max(a.values,function(a){return a.y0+a.y})}),m=d3.scale.ordinal().domain(t).rangeRoundBands([0,e],0.08),C=d3.scale.linear().domain([0,l]).range([0,c]);a=["#0055cc","#5bbdd8","#5fbe60","#fbb14e","#e95b57"];b=d3.svg.axis().scale(C).tickSize(0).tickPadding(6).orient("bottom");z=d3.select("#content").append("svg").attr("width",c+z+20).attr("height",
e+50+50).append("g").attr("transform","translate("+z+",50)");var D=z.selectAll(".layer").data(D).enter().append("g").attr("class","layer").style("fill",function(b,c){return a[c]}),E=D.selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("x",function(a){return 0}).attr("y",function(a,b){return m(b)}).attr("width",function(a){return 0}).attr("height",m.rangeBand()).attr("class",function(a,b){return"rect"}).attr("index_value",function(a,b){return t[b]+"-rect"}).on("mousemove",
function(a){var b=0,c=this.attributes.index_value.value.slice(0,-5),e;for(e in d)d[e].usuario===c&&(b=d[e].total);e=d3.selectAll(".custom-tooltip-bg")[0][0];a=d3.selectAll(".custom-tooltip")[0][0];b=c+" - Total: "+b+" pontos";c=a.getComputedTextLength();e.attributes.x.value=d3.mouse(this)[0]-11;e.attributes.y.value=d3.mouse(this)[1]-30;e.attributes.width.value=c+10;e.attributes.visibility.value="visible";a.attributes.x.value=d3.mouse(this)[0]-8;a.attributes.y.value=d3.mouse(this)[1]-16;a.textContent=
b;a.attributes.visibility.value="visible"}).on("mouseout",function(){d3.selectAll(".custom-tooltip-bg")[0][0].attributes.visibility.value="hidden";d3.selectAll(".custom-tooltip")[0][0].attributes.visibility.value="hidden"});E.transition().delay(function(a,b){return 10*b}).attr("x",function(a){return C(a.y0)}).attr("width",function(a){return C(a.y)});z.append("g").attr("class","x axis").attr("transform","translate(0,"+e+")").call(b);e+=30;z.append("g").attr("transform","translate("+c/2+","+e+")").append("svg:text").attr("class",
"title").text("Pontos");for(i=0;i<t.length;i++)z.append("g").attr("transform","translate(-6,"+(m(i)+m.rangeBand()/2+5)+")").append("svg:text").attr("text-anchor","end").attr("class","title").text(function(a){return t[i]});D.selectAll(".textValue").data(function(a){return a.values}).enter().append("text").attr("x",function(a){return C(a.y0+a.y)}).attr("y",function(a,b){return m(b)}).attr("dx",function(a){return-20}).attr("dy",m.rangeBand()/2+5).attr("fill","White").style("font-size","1.0em").text(function(a){if(0!==
a.y)return a.y});d3.selectAll("input").on("change",p);var H=setTimeout(function(){d3.select('input[value="grouped"]').property("checked",!0).each(p)},2E3);z.append("g").append("svg:rect").attr("class","custom-tooltip-bg").attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",60).attr("height",18).attr("visibility","hidden");z.append("g").append("svg:text").attr("x",0).attr("y",0).attr("class","custom-tooltip").attr("visibility","hidden").text("Tooltip").attr("fill","Black").style("font-size",
"1.0em")},error:function(a,d,b){"Bad Request"===d.statusText||"Internal Server Error"===d.statusText?($.logThis("Erro! "+d.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(d.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}})};window.TabelaView=Backbone.View.extend({tagName:"table",className:"table table-striped table-condensed",initialize:function(){$.logThis("Initializing Tabela View")},events:{"click #showMeBtn":"showMeBtnClick"},render:function(){$(this.el).html(this.template());return this},showMeBtnClick:function(){app.headerView.search()}});BolaoCopa.UsuarioView=BolaoCopa.View.extend({tagName:"div",initialize:function(){this.session=new SessionModel},render:function(){$(this.el).empty();if("admin"==$.cookie("papel")||"user"==$.cookie("papel"))BolaoCopa.View.prototype.render.call(this),$(this.el).append((new BolaoCopa.UsuarioListView).render().el);return this}});
BolaoCopa.UsuarioListView=BolaoCopa.ListView.extend({tagName:"table",className:"table table-striped table-condensed",session:null,initialize:function(){BolaoCopa.ListView.prototype.initialize.call(this);$.mockjax({url:"/papeis",responseText:{user:"user",guest:"guest",admin:"admin"}});this.ItemView=BolaoCopa.UsuarioItemView;this.collection=BolaoCopa.UsuarioCollection},render:function(){var a=this;$(this.el).empty();var d=new BolaoCopa.UsuarioCollection;"admin"==$.cookie("papel")&&"undefined"===typeof $(".dados-menu").attr("class")?
d.fetch({success:function(c,d,b){$(a.el).append((new UsuarioListItemViewHeader).render().el);$(a.el).append((new UsuarioListItemViewAddHeader).render().el);$(a.el).append('<tr><td colspan="5" class="td-right td-left">&nbsp;</td></tr>');$(a.el).append((new UsuarioListItemViewHeader).render().el);_.each(c.models,function(b){$(a.el).append((new BolaoCopa.UsuarioItemView({model:b})).render().el)},this);$(".usuarioeditablenew").editable({placement:"bottom",url:"/post",emptytext:"Vazio"});$(".usuarioeditablenew").on("save.newusuario",
function(){var a=this;setTimeout(function(){$(a).closest("tr").next().find(".usuarioeditablenew").editable("show")},200)});$("#novousuario").click(function(){$(".usuarioeditablenew").editable("submit",{url:"/usuarios",data:{senha:function(){return CryptoJS.SHA3($("#usuario-senha").text(),{outputLength:512}).toString(CryptoJS.enc.Base64)}},ajaxOptions:{dataType:"json"},success:function(b,c){if(b&&b.id){var d=new BolaoCopa.Usuario;d.attributes=b;$(".usuarioeditablenew").editable("setValue","").editable("option",
"pk",null);humane.log("Salvo com sucesso!",{addnCls:"humane-boldlight-success"});$(this).off("save.newusuario");$(a.el).append((new BolaoCopa.UsuarioItemView({model:d})).render().el);configura_UsuarioEditable_BtnApagar()}else b&&b.errors&&c.error.call(this,b.errors)},error:function(a){var b="";a&&a.responseText?b=a.getResponseHeader("X-Status-Reason"):$.each(a,function(a,c){b+=a+": "+c+"<br>"});humane.log(b,{addnCls:"humane-boldlight-error"})}})});configura_UsuarioEditable_BtnApagar()},error:function(a,
d,b){"Bad Request"==d.statusText||"Internal Server Error"==d.statusText?($.logThis("Erro! "+d.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(d.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}}):(d=$.cookie("usuario_id"),(new BolaoCopa.Usuario({id:d})).fetch({success:function(c,d,b){$(a.el).append("<h5>Modifique o seu nome e a sua senha aqui.</h5>");$(a.el).append((new UsuarioListItemViewHeader).render().el);
$(a.el).append((new BolaoCopa.UsuarioItemView({model:new BolaoCopa.Usuario(c.attributes)})).render().el);$(".usuarioeditable").editable({placement:"bottom",url:"/usuarios",emptytext:"-",ajaxOptions:{type:"put",dataType:"json",success:function(a,b,c){humane.log("Atualiza\u00e7\u00e3o realizada com sucesso!",{addnCls:"humane-boldlight-success"});$(".nome").text("Usu\u00e1rio: "+a.nome)},error:function(a,b,c){"Bad Request"==c||"Internal Server Error"==c?($.logThis("Erro! "+a.getResponseHeader("X-Status-Reason")),
humane.log("Erro de servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(a.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}}});$(".usuarioeditable").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!";if(-1!==this.className.indexOf("usuario-nome")&&20<a.length)return"M\u00e1ximo 20 caracteres!"})},error:function(a,d,b){"Bad Request"==d.statusText||"Internal Server Error"==d.statusText?($.logThis("Erro! "+
d.getResponseHeader("X-Status-Reason")),humane.log("Erro no servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(d.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}}));return a}});BolaoCopa.UsuarioItemView=BolaoCopa.ItemView.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.close,this)}});
window.UsuarioListItemViewHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});window.UsuarioListItemViewAddHeader=Backbone.View.extend({tagName:"tr",initialize:function(){},render:function(){$(this.el).html(this.template());return this}});
window.configura_UsuarioEditable_BtnApagar=function(){$(".usuarioeditable").editable({placement:"bottom",url:"/usuarios",emptytext:"-",params:function(a){"senha"==a.name&&(a.value=CryptoJS.SHA3(a.value,{outputLength:512}).toString(CryptoJS.enc.Base64));return a},ajaxOptions:{type:"put",dataType:"json",success:function(a,d,c){humane.log("Atualiza\u00e7\u00e3o realizada com sucesso!",{addnCls:"humane-boldlight-success"})},error:function(a,d,c){"Bad Request"==c||"Internal Server Error"==c?($.logThis("Erro! "+
xhr.getResponseHeader("X-Status-Reason")),humane.log("Erro de servidor! Favor entrar em contato com o suporte.",{addnCls:"humane-boldlight-error"})):humane.log(a.getResponseHeader("X-Status-Reason"),{addnCls:"humane-boldlight-error"})}}});$(".usuarioeditable").editable("option","validate",function(a){if(!a)return"Campo obrigat\u00f3rio!";if(-1!==this.className.indexOf("usuario-nome")&&20<a.length)return"O nome pode ter no m\u00e1ximo 20 caracteres!"});$(".btn-apagar").click(function(){var a=this;
$usuario=new BolaoCopa.Usuario;$usuario.set("id",this.dataset.pk);$usuario.destroy({success:function(d,c){c.error?$.logThis("Erro! "+c.responseText):(humane.log("Removido com sucesso!",{addnCls:"humane-boldlight-success"}),$(a).closest("tr").remove())},error:function(a,c){$.logThis("Erro! "+c.responseText);humane.log("Erro ao remover! Entre em contato com o suporte. ",{addnCls:"humane-boldlight-error"})}})})};
